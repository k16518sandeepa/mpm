<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telegram Streaming Site</title>
<link rel="stylesheet" href="static/style.css">
</head>
<body>
<h1>Telegram Streaming Site</h1>

<div id="player">
    <video id="videoPlayer" controls autoplay width="800">
        <source src="/stream?channel={{ videos[0].channel }}&msg_id={{ videos[0].msg_id }}" type="video/mp4">
        Your browser does not support the video tag.
    </video>
</div>

<h2>Playlist</h2>
<ul id="playlist">
    {% for video in videos %}
    <li data-channel="{{ video.channel }}" data-msg="{{ video.msg_id }}">
        {{ video.title }}
    </li>
    {% endfor %}
</ul>

<script>
const video = document.getElementById('videoPlayer');
const playlist = document.getElementById('playlist').children;

for (let item of playlist) {
    item.addEventListener('click', () => {
        const channel = item.dataset.channel;
        const msg_id = item.dataset.msg;
        video.src = `/stream?channel=${channel}&msg_id=${msg_id}`;
        video.play();
    });
}
</script>
</body>
</html>
